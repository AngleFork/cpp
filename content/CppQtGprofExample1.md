

[Go back to Richel Bilderbeek's C++ page](Cpp.htm).

 

 

 

 

 

([C++](Cpp.htm)) ![Qt](PicQt.png) [Qt Creator gprof example 1: profiling a simple console application](CppQtGprofExample1.htm)
==============================================================================================================================

 

This [Qt](CppQt.htm) example shows how to use [gprof](ToolGprof.htm)
under [Qt Creator](CppQt.htm) to profile a simple console application.

 

-   [Download the Qt Project of
    'CppQtGprofExample1' (zip)](CppQtGprofExample1.zip)

 

Operating system: [Ubuntu](http://www.ubuntu.com)

[IDE](CppIde.htm): [Qt Creator](CppQt.htm) 2.0.0

[Project type](CppQtProjectType.htm): Qt4 GUI Application

[Compiler](CppCompiler.htm): [G++](CppGpp.htm) 4.4.1

[Libraries](CppLibrary.htm) used:

-   [Boost](CppBoost.htm): version 1.40
-   [Qt](CppQt.htm): version 4.7.0 (32 bit)

 

 

 

 

 

Using [gprof](ToolGprof.htm) in [Qt Creator](CppQt.htm) 2.0.0
-------------------------------------------------------------

 

Here follows a step-by-step guide to use [gprof](ToolGprof.htm) to do
the profiling of a simple [Qt Creator](CppQt.htm) project:

 

1.  Go to 'Projects -&gt; Build Settings' and add a custom Build step.
    Fill in the information as in the screenshot below
2.  [View screenshot](CppQtGprofExample1_1.png)
3.  View your project folder. There will be few files
4.  [View screenshot](CppQtGprofExample1_2.png)
5.  Run the program. The executable 'profile\_main' has been created in
    your project folder
6.  [View screenshot](CppQtGprofExample1_3.png)
7.  Run 'profile\_main' and the file 'gmon.out' is created
8.  [View screenshot](CppQtGprofExample1_4.png)
9.  Start a Terminal, go to the project folder and use the command
    'gprof profile\_main &gt; profile.txt'
10. [View screenshot](CppQtGprofExample1_5.png)
11. The file 'profile.txt' will be created
12. [View screenshot](CppQtGprofExample1_6.png)
13. The file 'profile.txt' will contain the profiling information

 

 

 

 

 

[Qt project file](CppQtProjectFile.htm)
---------------------------------------

 

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #------------------------------------------------- # # Project created by QtCreator 2010-07-24T13:44:59 # #------------------------------------------------- QT       += core QT       -= gui TARGET = CppGprofExample1 CONFIG   += console CONFIG   -= app_bundle TEMPLATE = app SOURCES += main.cpp`
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

Source code
-----------

 

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include <algorithm> #include <cassert> #include <vector> #include <boost/foreach.hpp>  //From http://www.richelbilderbeek.nl/CppBubbleSort.htm template <class T> void BubbleSort(std::vector<T>& v) {   const int size = v.size();   for(int i=0; i!=size-1; ++i)   {     for(int j=0; j!=size-i-1; ++j)     {       if(v[j] > v[j+1])       {         std::swap(v[j],v[j+1]);       }     }   } }  //From http://www.richelbilderbeek.nl/CppInsertionSort.htm template <typename T> void InsertionSort(std::vector<T>& v) {   const int size = v.size();   for(int i=1; i!=size; ++i)   {     for(int j=0; j!=i; ++j)     {       if (v[j]>v[i])       {         const int temp=v[j];         v[j]=v[i];         for(int k=i;k>j;--k) { v[k]=v[k-1]; }         v[j+1]=temp;       }     }   } }  //From http://www.richelbilderbeek.nl/CppSelectionSort.htm template <typename T> void SelectionSort(std::vector<T>& v) {   const int size = v.size();   for(int i=0; i!=size-1; ++i)   {     for(int j=i+1; j!=size; ++j)     {       if (v[i]> v[j])       {         std::swap(v[i],v[j]);       }     }   } }  //From http://www.richelbilderbeek.nl/CppSortVector.htm template <class T> void SortVector(std::vector<T>& v) {   std::sort(v.begin(), v.end()); }  const std::vector<int> CreateShuffledVector(const std::size_t sz) {   std::vector<int> v(sz);    int value = 0;   BOOST_FOREACH(int i,v)   {     i = value;     ++value;   }   std::random_shuffle(v.begin(),v.end());   return v; }   int main() {   const std::vector<int> v = CreateShuffledVector(10000);    std::vector<int> v1(v);   std::vector<int> v2(v);   std::vector<int> v3(v);   std::vector<int> v4(v);    BubbleSort(v1);   InsertionSort(v2);   SelectionSort(v3);   SortVector(v4);    assert(v1==v2);   assert(v2==v3);   assert(v3==v4); }`
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

Profiling results
-----------------

 

Here I show the results comparing the five functions, copied from the
results file:

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` Flat profile:    %   cumulative   self              self     total  time   seconds   seconds    calls  ms/call  ms/call  name  13.59      1.54     0.28        1   280.00   700.00  void BubbleSort<int>(std::vector<int, std::allocator<int> >&)  12.14      1.79     0.25        1   250.00   670.00  void InsertionSort<int>(std::vector<int, std::allocator<int> >&)  11.65      2.03     0.24        1   240.00   660.00  void SelectionSort<int>(std::vector<int, std::allocator<int> >&)   0.00      2.06     0.00        1     0.00    24.98  void SortVector<int>(std::vector<int, std::allocator<int> >&)   0.00      2.06     0.00        1     0.00     5.02  CreateShuffledVector(unsigned int)`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

Conlusion: as expected, SortVector (a QuickSort) is by far the quickest
sorting algorithm.

 

 

 

 

 

[Go back to Richel Bilderbeek's C++ page](Cpp.htm).



 

[![Valid XHTML 1.0 Strict](valid-xhtml10.png){width="88"
height="31"}](http://validator.w3.org/check?uri=referer)
