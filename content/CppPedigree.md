
 

 

 

 

 

([C++](Cpp.md)) [Pedigree](CppPedigree.md)
============================================

 

Technical facts
---------------

 

 

 

 

 

 

./CppPedigree/CppPedigree.pri
-----------------------------

 

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` INCLUDEPATH += \     ../../Classes/CppPedigree  SOURCES += \     ../../Classes/CppPedigree/pedigree.cpp \     ../../Classes/CppPedigree/pedigree_test.cpp  HEADERS  += \     ../../Classes/CppPedigree/pedigree.h  OTHER_FILES += \     ../../Classes/CppPedigree/Licence.txt`
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppPedigree/pedigree.h
------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef PEDIGREE_H #define PEDIGREE_H  #include <memory> #include <vector> struct Pedigree : public std::enable_shared_from_this<Pedigree> {    Pedigree(     const std::string& name = "",     const std::weak_ptr<Pedigree> parent = std::weak_ptr<Pedigree>()   );   ~Pedigree();    ///Make an individual clean its deleted offspring   void CheckOffspring() const;    ///Start a Pedigree its ancestor   static std::shared_ptr<Pedigree> Create(const std::string& name = "") noexcept;    ///Create an offspring from this Pedigree member   std::shared_ptr<Pedigree> CreateOffspring(const std::string& name = "") noexcept;    ///Get the name of this Pedigree member   const std::string& GetName() const noexcept { return m_name; }    ///Get all current offspring of this Pedigree member   ///May contain weak_ptrs that are nullptr, call CheckOffspring to let these be removed   std::vector<std::weak_ptr<Pedigree>>& GetOffspring() const noexcept { return m_offspring; }    ///Get the ancestor of this Pedigree member, might be nullptr   std::weak_ptr<Pedigree> GetParent() const noexcept { return m_parent; }    ///Set the name of this Pedigree member   void SetName(const std::string& name) noexcept { m_name = name; }    ///Create the pedigree of this member in Newick format   std::string ToNewick() const;    ///Set the ancestor of this Pedigree member   void SetParent(const std::weak_ptr<Pedigree> parent) { m_parent = parent; }    ///Set verbosity of this class   void SetVerbose(const bool verbose) { m_verbose = verbose; }    private:   std::string m_name;   mutable std::vector<std::weak_ptr<Pedigree>> m_offspring;   std::weak_ptr<Pedigree> m_parent;   bool m_verbose;    ///Collect the std::string and depth of the offspring combined   std::pair<std::string,int> CollectNameDepthPair() const noexcept;    #ifndef NDEBUG   static void Test() noexcept;   #endif };  bool operator==(const Pedigree& lhs, const Pedigree& rhs) noexcept; bool operator!=(const Pedigree& lhs, const Pedigree& rhs) noexcept;  /* newick <- "(A):0;" # OK, but not plottable newick <- "(A:0);" # OK, but not plottable newick <- "(A:1);" # OK, but not plottable newick <- "(A:1,B:1);" # OK newick <- "(A:1,B:1):0;" # OK newick <- "(A:1,B:1):1;" # OK newick <- "(A:1,B:1):1,C:1;" # FAILS newick <- "(A:1,B:1):1,C;" # FAILS newick <- "(A:1,B:1):1,C:1;" # FAILS newick <- "(C:2,(A:1,B:1):1);" # OK newick <- "((A:1,B:1):1,C:1);" # OK */  #endif // PEDIGREE_H`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppPedigree/pedigree.cpp
--------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "pedigree.h"  #include <algorithm> #include <cassert> #include <iostream> #include <sstream>  Pedigree::Pedigree(   const std::string& name,   const std::weak_ptr<Pedigree> parent ) : m_name{name}, m_offspring{}, m_parent{parent}, m_verbose{false} {   #ifndef NDEBUG   Test();   #endif }  Pedigree::~Pedigree() {   if (m_verbose) { std::clog << "Destructor: " << m_name << std::endl; } }  void Pedigree::CheckOffspring() const {   //Erase-remove idiom to remove all nullptr kids   m_offspring.erase(     std::remove_if(std::begin(m_offspring),std::end(m_offspring),       [](auto kid) { return !kid.lock(); }     ),     std::end(m_offspring)   ); }  std::shared_ptr<Pedigree> Pedigree::Create(const std::string& name) noexcept {   std::shared_ptr<Pedigree> i = std::make_shared<Pedigree>(name);   return i; }  std::shared_ptr<Pedigree> Pedigree::CreateOffspring(const std::string& name) noexcept {   std::shared_ptr<Pedigree> kid = Create(name);   m_offspring.push_back(kid);   kid->SetParent(this->shared_from_this());   return kid; }  std::string Pedigree::ToNewick() const {   const std::pair<std::string,int> p{     CollectNameDepthPair()   };   std::stringstream s;   if (p.second == 0)   {     if (p.first.front() == '(' && p.first.back() == ')')     {       s << p.first << ";";     }     else     {       s << "(" << p.first << ");";     }   }   else   {     s << "(" << p.first << ":" << p.second << ");";   }   //Replace trailing comma by a trailing semicolon   return s.str(); }  std::pair<std::string,int> Pedigree::CollectNameDepthPair() const noexcept {   const bool verbose{false};   if (m_offspring.empty())   {     if (verbose) { std::clog << "No offspring\n"; }     return std::make_pair(GetName(),0);   }   else if (m_offspring.size() == 1)   {     if (verbose) { std::clog << "One offspring\n"; }     std::stringstream s;     const std::weak_ptr<Pedigree> kid_or_not{m_offspring[0]};     const std::shared_ptr<Pedigree> kid{kid_or_not.lock()};     if (!kid)     {       m_offspring.pop_back();       return CollectNameDepthPair();     }     assert(kid);     const std::pair<std::string,int> p{       kid->CollectNameDepthPair()     };     return std::make_pair(p.first,p.second + 1);   }   else   {     if (verbose) { std::clog << "More offspring\n"; }     std::stringstream s;     const auto end = std::end(m_offspring);     for (auto i = std::begin(m_offspring); i!=end; ++i)     //for (const std::weak_ptr<Pedigree>& kid_or_not: m_offspring)     {       const std::shared_ptr<Pedigree> kid{(*i).lock()};       if (!kid)       {         std::swap(*i,m_offspring.back());         assert(!m_offspring.back().lock()); //Must remove nullptr kid         m_offspring.pop_back();         return CollectNameDepthPair();       }       assert(kid);        const std::pair<std::string,int> p{         kid->CollectNameDepthPair()       };       s << p.first << ":" << (p.second + 1) << ",";     }     std::string t{s.str()};     assert(!t.empty());     t.pop_back();     t = "(" + t + ")";     return std::make_pair(t,0);   }   return std::make_pair("",0); }  bool operator==(const Pedigree& lhs, const Pedigree& rhs) noexcept {   return lhs.ToNewick() == rhs.ToNewick(); }  bool operator!=(const Pedigree& lhs, const Pedigree& rhs) noexcept {   return !(lhs == rhs); }`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppPedigree/pedigree\_test.cpp
--------------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "pedigree.h"  #include <algorithm> #include <cassert> #include <iostream> #include <sstream>  #ifndef NDEBUG void Pedigree::Test() noexcept {   {     static bool is_tested{false};     if (is_tested) return;     is_tested = true;   }   //operator==   {     const std::string name = "Eve";     const auto pedigree1 = Pedigree::Create(name);     const auto pedigree2 = Pedigree::Create(name);     assert(*pedigree1 == *pedigree2);   }   //operator!=   {     const auto pedigree1 = Pedigree::Create("Adam");     const auto pedigree2 = Pedigree::Create("Eve");     assert(*pedigree1 != *pedigree2);   }   //Single parent construction   {     const std::string name = "Eve";     const auto parent = Pedigree::Create(name);     assert(parent->GetName() == name);     assert(!parent->GetParent().lock());     assert(parent->GetOffspring().empty());   }   //Parent and offspring construction   {     const auto parent = Pedigree::Create();     const auto kid = parent->CreateOffspring();     assert(parent->GetOffspring().size() == 1);     assert(parent->GetOffspring()[0].lock());     assert(parent->GetOffspring()[0].lock() == kid);     assert(kid->GetParent().lock());     assert(kid->GetParent().lock() == parent);   }   //Parent and two offspring construction   {     const auto parent = Pedigree::Create();     const auto kid1 = parent->CreateOffspring();     const auto kid2 = parent->CreateOffspring();     assert(parent->GetOffspring().size() == 2);     assert(parent->GetOffspring()[0].lock());     assert(parent->GetOffspring()[0].lock() == kid1);     assert(parent->GetOffspring()[1].lock());     assert(parent->GetOffspring()[1].lock() == kid2);     assert(kid1->GetParent().lock());     assert(kid1->GetParent().lock() == parent);     assert(kid2->GetParent().lock());     assert(kid2->GetParent().lock() == parent);   }   //Parent and one offspring construction, kid goes out of scope   {     const auto parent = Pedigree::Create();     {       const auto kid1 = parent->CreateOffspring();       const auto kid2 = parent->CreateOffspring();       assert(parent->GetOffspring().size() == 2);     }     parent->CheckOffspring();     assert(parent->GetOffspring().size() == 0);   }   //Create offspring from offspring   {     const auto parent = Pedigree::Create();     const auto a = parent->CreateOffspring();     const auto b = parent->CreateOffspring();     const auto c = a->CreateOffspring();     const auto d = a->CreateOffspring();     const auto e = b->CreateOffspring();     const auto f = b->CreateOffspring();     assert(c->GetParent().lock()->GetParent().lock() == parent);     assert(d->GetParent().lock()->GetParent().lock() == parent);     assert(e->GetParent().lock()->GetParent().lock() == parent);     assert(f->GetParent().lock()->GetParent().lock() == parent);   }   //Create offspring from offspring, kill second generation   {     std::vector<decltype(Pedigree::Create())> population;     {       const auto parent = Pedigree::Create();       const auto a = parent->CreateOffspring();       const auto b = a->CreateOffspring();       population.push_back(parent);       population.push_back(b);     }     population[0]->CheckOffspring();     assert(population[0]->GetOffspring().empty() && "Second generation died");     assert(!population[1]->GetParent().lock() && "Second generation died");   }   {     const auto root = Pedigree::Create("X");     const std::string expected{"(X);"};     if (root->ToNewick() != expected) { std::cerr << root->ToNewick() << '\n'; }     assert(root->ToNewick() == expected);   }   //Single lineage, one generation   {     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const std::string expected{"(A:1);"};     if(root->ToNewick() != expected) { std::cerr << root->ToNewick() << '\n';}     assert(root->ToNewick() == expected);   }   //Single lineage, two generations   {     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = a->CreateOffspring("B");     assert(b->ToNewick() == "(B);");     assert(a->ToNewick() == "(B:1);");     assert(root->ToNewick() == "(B:2);");   }   {     /*       +-A      |    --X      |      +-B      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const std::string expected{"(A:1,B:1);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Three branches of short length   {     /*         +-C        |      +-A      | |    --X +-D      |      +-B-E      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const std::string expected{"((C:1,D:1):1,E:2);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Three branches of one longer length   {     /*         +-C-F        |      +-A      | |    --X +-D-G      |      +-B-E-H      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const auto f = c->CreateOffspring("F");     const auto g = d->CreateOffspring("G");     const auto h = e->CreateOffspring("H");     const std::string expected{"((F:2,G:2):1,H:3);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Four branches of short length with one trichomy   {     /*         +-C        |      +-A-D      | |    --X +-E      |      +-B-F      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = a->CreateOffspring("E");     const auto f = b->CreateOffspring("F");     const std::string expected{"((C:1,D:1,E:1):1,F:2);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Four branches of short length, two dichotomies   {     /*         +-C        |      +-A      | |      | +-D    --X      | +-E      | |      +-B        |        +-F      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const auto f = b->CreateOffspring("F");     const std::string expected{"((C:1,D:1):1,(E:1,F:1):1);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Four branches of one longer length with one trichomy   {     /*         +-C-G        |      +-A-D-H      | |    --X +-E-I      |      +-B-F-J      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = a->CreateOffspring("E");     const auto f = b->CreateOffspring("F");      const auto g = c->CreateOffspring("G");     const auto h = d->CreateOffspring("H");     const auto i = e->CreateOffspring("I");     const auto j = f->CreateOffspring("J");      const std::string expected{"((G:2,H:2,I:2):1,J:3);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Four branches with one longer length, two dichotomies   {     /*         +-C-G        |      +-A      | |      | +-D-H    --X      | +-E-I      | |      +-B        |        +-F-J      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const auto f = b->CreateOffspring("F");      const auto g = c->CreateOffspring("G");     const auto h = d->CreateOffspring("H");     const auto i = e->CreateOffspring("I");     const auto j = f->CreateOffspring("J");      const std::string expected{"((G:2,H:2):1,(I:2,J:2):1);"};      const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }    //Four branches with two dichotomies of different length   {     /*         +-C-F        |      +-A      | |      | +-D-G    --X      |   +-H      |   |      +-B-E          |          +-I      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const auto f = c->CreateOffspring("F");     const auto g = d->CreateOffspring("G");     const auto h = e->CreateOffspring("H");     const auto i = e->CreateOffspring("I");     const std::string expected{"((F:2,G:2):1,(H:1,I:1):2);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Three branches of one longer length, killing F   {     /*         +-C-F           +-C        |               |      +-A             +-A      | |       ->    | |    --X +-D-G       --X +-D-G      |               |      +-B-E-H         +-B-E-H      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     {       const auto f = c->CreateOffspring("F");     }     const auto g = d->CreateOffspring("G");     const auto h = e->CreateOffspring("H");     const std::string expected{"((C:1,G:2):1,H:3);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Three branches of one longer length, killing C   {     /*         +-C-F        |      +-A            +-A      | |      ->    | |    --X +-D-G      --X +-D-G      |              |      +-B-E-H        +-B-E-H      */     const auto root = Pedigree::Create("X");     const auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const auto f = c->CreateOffspring("F");     const auto g = d->CreateOffspring("G");     const auto h = e->CreateOffspring("H");     c = std::shared_ptr<Pedigree>();     const std::string expected{"(G:3,H:3);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   }   //Three branches of one longer length, killing A   {     /*         +-C-F        |      +-A      | |      ->    --X +-D-G      --X      |              |      +-B-E-H        +-B-E-H      */     const auto root = Pedigree::Create("X");     auto a = root->CreateOffspring("A");     const auto b = root->CreateOffspring("B");     const auto c = a->CreateOffspring("C");     const auto d = a->CreateOffspring("D");     const auto e = b->CreateOffspring("E");     const auto f = c->CreateOffspring("F");     const auto g = d->CreateOffspring("G");     const auto h = e->CreateOffspring("H");     a = std::shared_ptr<Pedigree>();     const std::string expected{"(H:3);"};     const std::string found{root->ToNewick()};     if (found != expected) { std::cerr << found << '\n'; }     assert(found == expected);   } } #endif`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

 

