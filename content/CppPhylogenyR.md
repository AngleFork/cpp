
 

 

 

 

 

([C++](Cpp.md)) [PhylogenyR](CppPhylogenyR.md)
================================================

 

Technical facts
---------------

 

 

 

 

 

 

./CppPhylogenyR/CppPhylogenyR.pri
---------------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` INCLUDEPATH += \     ../../Classes/CppPhylogenyR  SOURCES += \     ../../Classes/CppPhylogenyR/phylogeny_r.cpp \     ../../Classes/CppPhylogenyR/phylogeny_r_test.cpp  HEADERS  += \     ../../Classes/CppPhylogenyR/phylogeny_r.h  OTHER_FILES += \     ../../Classes/CppPhylogenyR/Licence.txt`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppPhylogenyR/phylogeny\_r.h
------------------------------

 

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef RIBI_PHYLOGENY_R_H #define RIBI_PHYLOGENY_R_H  #include <memory> #include <string> #include <vector>  #include "RInside.h"  struct RInside;  namespace ribi {  struct PhylogenyR {   enum class GraphicsFormat { png, svg };    PhylogenyR();    ///Remove the lineages that are extinct at the present time   ///Throws std::runtime_error if R script fails   std::string DropExtinct(     const std::string& newick   ) const;    std::string GetVersion() const noexcept;   std::vector<std::string> GetVersionHistory() const noexcept;    ///Make a histogram of the branching times   void NewickToBranchingTimes(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Make a histogram of the branch length   void NewickToBranchLengths(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Plot Newick as a Lineages Through Time Plot in PNG format   void NewickToLttPlot(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Plot Newick as a phylogeny in a graphics format   ///same interface is followed by NewickUtils   void NewickToPhylogeny(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Converts a phylogeny, with the   ///name 'phylogeny_name' known   ///inside RInside to std::string   std::string PhylogenyToNewick(     const std::string& phylogeny_name   );     private:    ///Make a histogram of the branching times   void NewickToBranchingTimesRinside(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Make a histogram of the branching times   void NewickToBranchingTimesRscript(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Make a histogram of the branch length   void NewickToBranchLengthsRinside(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    ///Make a histogram of the branch length   void NewickToBranchLengthsRscript(     const std::string& newick,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;     #ifndef NDEBUG   static void Test() noexcept;   #endif };  } //~namespace ribi  #endif // RIBI_PHYLOGENY_R_H`
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppPhylogenyR/phylogeny\_r.cpp
--------------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "phylogeny_r.h"  #include <cassert> #include <fstream> #include <sstream> #include <iostream> #include <future>  #include "ribi_rinside.h" #include "fileio.h"  ribi::PhylogenyR::PhylogenyR() {   #ifndef NDEBUG   Test();   #endif }  std::string ribi::PhylogenyR::DropExtinct(const std::string& newick) const {   assert(!newick.empty());    auto& r = ribi::Rinside().Get();   r.parseEval("library(ape)");   r.parseEval("library(geiger)");   r["newick"] = newick;   r.parseEval("phylogeny <- read.tree(text = newick)");   r.parseEval("phylogeny <- drop.extinct(phylogeny)");   const Rcpp::String s = r.parseEval("write.tree(phylogeny)");   return std::string(s); }  std::string ribi::PhylogenyR::GetVersion() const noexcept {   return "1.0"; }  std::vector<std::string> ribi::PhylogenyR::GetVersionHistory() const noexcept {   return {     "2015-06-13: Version 1.0: started versioning"   }; }  void ribi::PhylogenyR::NewickToBranchingTimes(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   NewickToBranchingTimesRinside(newick,filename,graphics_format); }  void ribi::PhylogenyR::NewickToBranchingTimesRinside(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   NewickToBranchingTimesRscript(newick,filename,graphics_format); }  void ribi::PhylogenyR::NewickToBranchingTimesRscript(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   //TODO: Test if the user has all required packages    const std::string temp_r_filename{     ribi::fileio::FileIo().GetTempFileName(".R")   };    //Create the R script   {     std::ofstream f(temp_r_filename.c_str());     f       << "library(ape)" << '\n'       << "library(geiger)" << '\n'     ;     switch (graphics_format)     {       case GraphicsFormat::png:         f << "png(filename=\"" << filename << "\")" << '\n';       break;       case GraphicsFormat::svg:         f << "svg(filename=\"" << filename << "\")" << '\n';       break;     }      f       << "newick <- \"" << newick << "\"" << '\n'       << "phylogeny <- read.tree(text = newick)" << '\n'       << "branching_times <- branching.times(phylogeny)" << '\n'       << "hist(branching_times)" << '\n'       << "dev.off()" << '\n';     ;   }    if (!ribi::fileio::FileIo().IsRegularFile(temp_r_filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create temporary R script file "       << "with filename '" << temp_r_filename << "'";     throw std::runtime_error(s.str().c_str());   }    //Execute the R script   {     std::stringstream cmd;     cmd << "Rscript " << temp_r_filename;     const int error{std::system(cmd.str().c_str())};     if (error)     {       std::clog << __FILE__ << ": error " << error << '\n';     }   }    if (!ribi::fileio::FileIo().IsRegularFile(filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create SVG "       << "with filename '" << filename << "'. "       << "Perhaps not all packages (ape, geiger) needed are installed? "       << "You can try to run the temporary R script file '"       << temp_r_filename       << "' yourself to see which error it gives"     ;     throw std::runtime_error(s.str().c_str());   }    //Delete the temporary R file   ribi::fileio::FileIo().DeleteFile(temp_r_filename); }  void ribi::PhylogenyR::NewickToBranchLengths(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   NewickToBranchLengthsRinside(newick,filename,graphics_format); }  void ribi::PhylogenyR::NewickToBranchLengthsRinside(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   NewickToBranchLengthsRscript(newick,filename,graphics_format); }  void ribi::PhylogenyR::NewickToBranchLengthsRscript(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   //TODO: Test if the user has all required packages    const std::string temp_r_filename{     ribi::fileio::FileIo().GetTempFileName(".R")   };    //Create the R script   {     std::ofstream f(temp_r_filename.c_str());     f       << "library(ape)" << '\n'       << "library(geiger)" << '\n'     ;     switch (graphics_format)     {       case GraphicsFormat::png:         f << "png(filename=\"" << filename << "\")" << '\n';       break;       case GraphicsFormat::svg:         f << "svg(filename=\"" << filename << "\")" << '\n';       break;     }      f       << "newick <- \"" << newick << "\"" << '\n'       << "phylogeny <- read.tree(text = newick)" << '\n'       << "branch_lengths <- phylogeny$edge.length" << '\n'       << "hist(branch_lengths)" << '\n'       << "dev.off()" << '\n';     ;   }    if (!ribi::fileio::FileIo().IsRegularFile(temp_r_filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create temporary R script file "       << "with filename '" << temp_r_filename << "'";     throw std::runtime_error(s.str().c_str());   }    //Execute the R script   {     std::stringstream cmd;     cmd << "Rscript " << temp_r_filename;     const int error{std::system(cmd.str().c_str())};     if (error)     {       std::clog << __FILE__ << ": error " << error << '\n';     }   }    if (!ribi::fileio::FileIo().IsRegularFile(filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create SVG "       << "with filename '" << filename << "'. "       << "Perhaps not all packages (ape, geiger) needed are installed? "       << "You can try to run the temporary R script file '"       << temp_r_filename       << "' yourself to see which error it gives"     ;     throw std::runtime_error(s.str().c_str());   }    //Delete the temporary R file   ribi::fileio::FileIo().DeleteFile(temp_r_filename); }  void ribi::PhylogenyR::NewickToLttPlot(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   assert(!newick.empty());   assert(!filename.empty());    //TODO: Test if the user has all required packages   auto& r = ribi::Rinside().Get();    r.parseEvalQ("library(ape)");   r.parseEvalQ("library(geiger)");   r["temp_filename"] = filename;   r["newick"] = newick;   r.parseEvalQ("phylogeny <- read.tree(text = newick)");    switch (graphics_format)   {     case GraphicsFormat::png:       r.parseEvalQ("png(filename=temp_filename)");     break;     case GraphicsFormat::svg:       r.parseEvalQ("svg(filename=temp_filename)");     break;   }   r.parseEvalQ("ltt.plot(phylogeny)");   r.parseEvalQ("dev.off()");    if (!ribi::fileio::FileIo().IsRegularFile(filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create SVG "       << "with filename '" << filename << "'. "       << "Perhaps not all packages (ape, geiger) needed are installed?"     ;     throw std::runtime_error(s.str().c_str());   } }  void ribi::PhylogenyR::NewickToPhylogeny(   const std::string& newick,   const std::string& filename,   const ribi::PhylogenyR::GraphicsFormat graphics_format ) const {   assert(!newick.empty());   assert(!filename.empty());    //TODO: Test if the user has all required packages   auto& r = ribi::Rinside().Get();    r.parseEvalQ("library(ape)");   r.parseEvalQ("library(geiger)");   r["temp_filename"] = filename;   r["newick"] = newick;   r.parseEvalQ("phylogeny <- read.tree(text = newick)");    switch (graphics_format)   {     case GraphicsFormat::png:       r.parseEvalQ("png(filename=temp_filename)");     break;     case GraphicsFormat::svg:       r.parseEvalQ("svg(filename=temp_filename)");     break;   }   r.parseEvalQ("plot(phylogeny)");   r.parseEvalQ("dev.off()");     if (!ribi::fileio::FileIo().IsRegularFile(filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create image "       << "with filename '" << filename << "'. "       << "Perhaps not all packages (ape, geiger) needed are installed?"     ;     throw std::runtime_error(s.str().c_str());   } }  std::string ribi::PhylogenyR::PhylogenyToNewick(   const std::string& phylogeny_name ) {   auto& r = ribi::Rinside().Get();   const Rcpp::String s = r.parseEval("write.tree("+ phylogeny_name + ")");   const std::string t = s;   return t; }`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppPhylogenyR/phylogeny\_r\_test.cpp
--------------------------------------

 

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "phylogeny_r.h"  #include <cassert> #include <chrono>  #include "fileio.h" #include "testtimer.h" #include "trace.h" #include "ribi_rinside.h" #include "RInside.h"  #ifndef NDEBUG void ribi::PhylogenyR::Test() noexcept {   {     static bool is_tested{false};     if (is_tested) return;     is_tested = true;   }   {     ribi::fileio::FileIo();     auto& r = ribi::Rinside().Get();     r.parseEvalQ("library(ape)");     r.parseEvalQ("library(geiger)");   }   const ribi::TestTimer test_timer(__func__,__FILE__,1.0);   const bool verbose{false};    ribi::fileio::FileIo f;    PhylogenyR p;    if (verbose) { TRACE("NewickToPhylogeny as SVG of extinct and extant species"); }   {     const std::string temp_svg_filename{       f.GetTempFileName(".svg")     };     const std::string newick{"((F:2,G:2):1,H:3);"};     p.NewickToPhylogeny(       newick,       temp_svg_filename,       ribi::PhylogenyR::GraphicsFormat::svg     );     assert(f.IsRegularFile(temp_svg_filename));     //Clean up     f.DeleteFile(temp_svg_filename);   }   if (verbose) { TRACE("NewickToPhylogeny as PNG of extant species"); }   {     const std::string temp_png_filename{       f.GetTempFileName(".png")     };     const std::string newick{"((F:2,G:2):1,H:3);"};     p.NewickToPhylogeny(       newick,       temp_png_filename,       ribi::PhylogenyR::GraphicsFormat::png     );     assert(f.IsRegularFile(temp_png_filename));     //Clean up     f.DeleteFile(temp_png_filename.c_str());   }   #ifdef FIX_ISSUE_267   if (verbose) { TRACE("NewickToPhylogenyPng on hard phylogeny"); }   {     const TimePoint t{Clock::now()};      const std::string temp_png_filename{       f.GetTempFileName(".png")     };     const std::string newick{"((ER:1,GR:1):1);"};     p.NewickToPhylogenyPng(newick,temp_png_filename);     assert(f.IsRegularFile(temp_png_filename));     //Clean up     f.DeleteFile(temp_png_filename.c_str());       std::cout << "4: " << std::chrono::duration_cast<Msec>(Clock::now() - t).count() << " milliseconds" << '\n';   }   #endif   if (verbose) { TRACE("NewickToLttPlot"); }   {     const std::string temp_png_filename{       f.GetTempFileName(".png")     };     const std::string newick{"((F:2,G:2):1,H:3);"};     p.NewickToLttPlot(newick,temp_png_filename,GraphicsFormat::png);     assert(f.IsRegularFile(temp_png_filename));     //Clean up     f.DeleteFile(temp_png_filename.c_str());   }   if (verbose) { TRACE("DropExtinct"); }   {     assert(       p.DropExtinct(         "(L:1,(((((XD:1,ZD:1):1,CE:2):1,(FE:2,EE:2):1):1,(GD:1,ID:1):1,BD:1):3,(AC:1,EC:1):1,(((TC:1,FD:2):1,QC:1,RC:1):1,((((AE:1,BE:1):1,(WD:1,YD:1):1):1,HD:1):2,MC:1):1):1):3);"       ) == "((((XD:1,ZD:1):1,CE:2):1,(FE:2,EE:2):1):4,((AE:1,BE:1):1,(WD:1,YD:1):1):5);"     );   }   if (verbose) { TRACE("PhylogenyToNewick"); }   {     const std::string s{"((F:2,G:2):1,H:3);"};     auto& r = ribi::Rinside().Get();     r["newick"] = s;     r.parseEval("phylogeny <- read.tree(text = newick)");     const std::string t{p.PhylogenyToNewick("phylogeny")};     assert(s == t);   } } #endif`
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

 

This page has been created by the [tool](Tools.md)
[CodeToHtml](ToolCodeToHtml.md)
