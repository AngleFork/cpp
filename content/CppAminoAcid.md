
 

 

 

 

 

([C++](Cpp.md)) [AminoAcid](CppAminoAcid.md)
==============================================

 

![STL](PicStl.png)

 

[AminoAcid](CppAminoAcid.md) contains some [classes](CppClass.md) to
work with amino acids.

Technical facts
---------------

 

 

 

 

 

 

./CppAminoAcid/CppAminoAcid.pri
-------------------------------

 

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` INCLUDEPATH += \     ../../Games/GameAminoAcidFighter  SOURCES += \     ../../Games/GameAminoAcidFighter/aafmenudialog.cpp \     ../../Games/GameAminoAcidFighter/aafaminoacid.cpp \     ../../Games/GameAminoAcidFighter/aafaminoacids.cpp \     ../../Games/GameAminoAcidFighter/aaffighter.cpp \     ../../Games/GameAminoAcidFighter/aaffighterfactory.cpp \     ../../Games/GameAminoAcidFighter/aafmolecule.cpp \     ../../Games/GameAminoAcidFighter/aafatom.cpp \     ../../Games/GameAminoAcidFighter/aafbond.cpp \     ../../Games/GameAminoAcidFighter/aafmoleculefactory.cpp \     ../../Games/GameAminoAcidFighter/aafatomtype.cpp  HEADERS  += \     ../../Games/GameAminoAcidFighter/aafmenudialog.h \     ../../Games/GameAminoAcidFighter/aafaminoacid.h \     ../../Games/GameAminoAcidFighter/aafaminoacids.h \     ../../Games/GameAminoAcidFighter/aaffighter.h \     ../../Games/GameAminoAcidFighter/aaffighterfactory.h \     ../../Games/GameAminoAcidFighter/aaffwd.h \     ../../Games/GameAminoAcidFighter/aafmolecule.h \     ../../Games/GameAminoAcidFighter/aafatom.h \     ../../Games/GameAminoAcidFighter/aafbond.h \     ../../Games/GameAminoAcidFighter/aafmoleculefactory.h \     ../../Games/GameAminoAcidFighter/aafatomtype.h  OTHER_FILES += \     ../../Games/GameAminoAcidFighter/Licence.txt  RESOURCES += \     ../../Games/GameAminoAcidFighter/GameAminoAcidFighter.qrc`
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafaminoacid.h
-----------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFAMINOACID_H #define AAFAMINOACID_H  namespace ribi { namespace aaf {  enum class AminoAcid {   alanine,   arginine,   asparagine,   aspartic_acid,   cysteine,   glutamic_acid,   glutamine,   glycine,   histidine,   isoleucine,   leucine,   lysine,   methionine,   ornithine, //Bonus   phenylalanine,   proline,   selenocysteine, //Bonus   serine,   threonine,   tryptophan,   tyrosine,   valine,   n_types //Used for debugging };  } //~namespace aaf } //~namespace ribi  #endif // AAFAMINOACID_H`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafaminoacid.cpp
-------------------------------

 

  ------------------------------
  ` #include "aafaminoacid.h"`
  ------------------------------

 

 

 

 

 

./CppAminoAcid/aafaminoacids.h
------------------------------

 

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFAMINOACIDS_H #define AAFAMINOACIDS_H  #include <string> #include <vector>  #include "aafaminoacid.h"  #pragma GCC diagnostic push #pragma GCC diagnostic ignored "-Weffc++" #pragma GCC diagnostic ignored "-Wunused-local-typedefs" #include <boost/bimap.hpp> #pragma GCC diagnostic pop  namespace ribi { namespace aaf {  struct AminoAcids {   AminoAcids();   std::vector<AminoAcid> GetAll() const noexcept;   std::string ToStr(const AminoAcid s) const noexcept;   AminoAcid ToType(const std::string& s) const;    private:   static boost::bimap<AminoAcid,std::string> m_map;   static boost::bimap<AminoAcid,std::string> CreateMap();    #ifndef NDEBUG   static void Test() noexcept;   #endif };  } //~namespace aaf } //~namespace ribi  #endif // AAFAMINOACIDS_H`
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafaminoacids.cpp
--------------------------------

 

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "aafaminoacids.h"  #include <cassert>  #include "testtimer.h" #include "trace.h"  boost::bimap<ribi::aaf::AminoAcid,std::string> ribi::aaf::AminoAcids::m_map;  ribi::aaf::AminoAcids::AminoAcids() {   #ifndef NDEBUG   Test();   #endif }  boost::bimap<ribi::aaf::AminoAcid,std::string> ribi::aaf::AminoAcids::CreateMap() {   boost::bimap<AminoAcid,std::string> m;   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::alanine,"alanine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::arginine,"arginine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::asparagine,"asparagine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::aspartic_acid,"aspartic_acid"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::cysteine,"cysteine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::glutamic_acid,"glutamic_acid"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::glutamine,"glutamine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::glycine,"glycine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::histidine,"histidine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::isoleucine,"isoleucine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::leucine,"leucine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::lysine,"lysine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::methionine,"methionine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::ornithine,"ornithine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::phenylalanine,"phenylalanine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::proline,"proline"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::selenocysteine,"selenocysteine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::serine,"serine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::threonine,"threonine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::tryptophan,"tryptophan"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::tyrosine,"tyrosine"));   m.insert(boost::bimap<AminoAcid,std::string>::value_type(AminoAcid::valine,"valine"));   return m; }  std::vector<ribi::aaf::AminoAcid> ribi::aaf::AminoAcids::GetAll() const noexcept {   const std::vector<AminoAcid> v {     AminoAcid::alanine,     AminoAcid::arginine,     AminoAcid::asparagine,     AminoAcid::aspartic_acid,     AminoAcid::cysteine,     AminoAcid::glutamic_acid,     AminoAcid::glutamine,     AminoAcid::glycine,     AminoAcid::histidine,     AminoAcid::isoleucine,     AminoAcid::leucine,     AminoAcid::lysine,     AminoAcid::methionine,     AminoAcid::ornithine,     AminoAcid::phenylalanine,     AminoAcid::proline,     AminoAcid::selenocysteine,     AminoAcid::serine,     AminoAcid::threonine,     AminoAcid::tryptophan,     AminoAcid::tyrosine,     AminoAcid::valine   };   assert(static_cast<int>(v.size()) == static_cast<int>(AminoAcid::n_types));   return v; }  #ifndef NDEBUG void ribi::aaf::AminoAcids::Test() noexcept {   {     static bool is_tested{false};     if (is_tested) return;     is_tested = true;   }   const TestTimer test_timer(__func__,__FILE__,1.0);   const std::vector<AminoAcid> v = AminoAcids().GetAll();   const std::size_t sz = v.size();   for (std::size_t i=0; i!=sz; ++i)   {     assert(i < v.size());     const AminoAcid t = v[i];     const std::string s = AminoAcids().ToStr(t);     assert(!s.empty());     const AminoAcid u = AminoAcids().ToType(s);     assert(u == t);   } } #endif  std::string ribi::aaf::AminoAcids::ToStr(const AminoAcid type) const noexcept {   if (m_map.left.empty()) m_map = CreateMap();   assert(!m_map.left.empty());   assert(m_map.left.count(type));   const std::string s = m_map.left.find(type)->second;   return s; }  ribi::aaf::AminoAcid ribi::aaf::AminoAcids::ToType(const std::string& s) const {   if (m_map.right.empty()) m_map = CreateMap();   assert(!m_map.right.empty());   assert(m_map.right.count(s) == 1);   const AminoAcid t = m_map.right.find(s)->second;   return t; }`
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafatom.h
------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFATOM_H #define AAFATOM_H  #include "polarcoordinat.h"  #pragma GCC diagnostic push #pragma GCC diagnostic ignored "-Weffc++" #pragma GCC diagnostic ignored "-Wunused-local-typedefs" #include <boost/units/systems/si/plane_angle.hpp> #include "aafatomtype.h" #pragma GCC diagnostic pop  namespace ribi { namespace aaf {  struct Atom {   typedef boost::units::quantity<boost::units::si::plane_angle> Angle;   typedef boost::units::quantity<boost::units::si::length> Length;    Atom(     const AtomType type = AtomType::H,     const PolarCoordinat<Angle,Length> coordinat = CreateDefaultCoordinat()   );    private:   PolarCoordinat<Angle,Length> m_coordinat;   AtomType m_type;    static PolarCoordinat<Angle,Length> CreateDefaultCoordinat() noexcept;  };  } //~namespace aaf } //~namespace ribi  #endif // AAFATOM_H`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafatom.cpp
--------------------------

 

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "aafatom.h"  ribi::aaf::Atom::Atom(   const AtomType type,   const PolarCoordinat<Angle,Length> coordinat ) : m_coordinat(coordinat),     m_type(type) {  }  /* ribi::aaf::Atom::Atom(   const AtomType type,   const Angle angle,   const Length length ) : m_coordinat(angle,length),     m_type(type) {  } */   ribi::PolarCoordinat<ribi::aaf::Atom::Angle,ribi::aaf::Atom::Length> ribi::aaf::Atom::CreateDefaultCoordinat() noexcept {   return PolarCoordinat<Angle,Length>(     0.0 * boost::units::si::radian,     0.0 * boost::units::si::meter   ); }`
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafatomtype.h
----------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFATOMTYPE_H #define AAFATOMTYPE_H  namespace ribi { namespace aaf {  enum class AtomType {   H,   O,   N,   C,   S };  } //~namespace aaf } //~namespace ribi  #endif // AAFATOMTYPE_H`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafatomtype.cpp
------------------------------

 

  -----------------------------
  ` #include "aafatomtype.h"`
  -----------------------------

 

 

 

 

 

./CppAminoAcid/aafbond.h
------------------------

 

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFBOND_H #define AAFBOND_H  #include <string>  #pragma GCC diagnostic push #pragma GCC diagnostic ignored "-Weffc++" #pragma GCC diagnostic ignored "-Wunused-local-typedefs" //#include <boost/units/unit.hpp> #include <boost/units/quantity.hpp> #include <boost/units/systems/si/length.hpp> #pragma GCC diagnostic pop   namespace ribi { namespace aaf {  struct Bond {   typedef boost::units::quantity<boost::units::si::length,double> Length;     Bond(const int n_bonds = 1) : m_n_bonds(n_bonds) {}    private:   int m_n_bonds; };  boost::units::quantity<boost::units::si::length,double> GetAverageBondLength() noexcept;  } //~namespace aaf } //~namespace ribi  #endif // AAFBOND_H`
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafbond.cpp
--------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "aafbond.h"  #include <cassert>  #include <boost/units/systems/si/prefixes.hpp>  boost::units::quantity<boost::units::si::length,double> ribi::aaf::GetAverageBondLength() noexcept {   return boost::units::quantity<boost::units::si::length,double>(     109.0     * boost::units::si::pico     * boost::units::si::meter   ); }`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aaffwd.h
-----------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFFWD_H #define AAFFWD_H  namespace ribi { namespace aaf {  struct Fighter; struct FighterFactory;  } //~namespace aaf { } //namespace ribi {  #endif // AAFFWD_H`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafmolecule.h
----------------------------

 

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFMOLECULE_H #define AAFMOLECULE_H  #pragma GCC diagnostic push #pragma GCC diagnostic ignored "-Weffc++" #pragma GCC diagnostic ignored "-Wunused-local-typedefs" #include <boost/graph/adjacency_list.hpp> #include <boost/shared_ptr.hpp>  #include "aafatom.h" #include "aafbond.h" #pragma GCC diagnostic pop  namespace ribi {  struct TextCanvas;  namespace aaf {  struct Molecule {   typedef boost::adjacency_list   <     //Store all edges as a std::vector     boost::vecS,     //Store all vertices in a std::vector     boost::vecS,     //Relations are both ways     boost::undirectedS,     //All vertices are person names of type std::string     //boost::property<boost::vertex_name_t,std::string>,     boost::property<boost::vertex_name_t,Atom>,     //All edges are weights equal to the encounter frequencies     boost::property<boost::edge_name_t,Bond>,     //Graph itself has a std::string name     boost::property<boost::graph_name_t,std::string>   > Graph;    boost::shared_ptr<TextCanvas> ToTextCanvas() const noexcept;    //private:   Molecule(const Graph& graph) : m_graph(graph) {}    Graph m_graph; };    } //~namespace aaf { } //~namespace ribi {  #endif // AAFMOLECULE_H`
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafmolecule.cpp
------------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "aafmolecule.h"  #include "aafbond.h"  boost::shared_ptr<ribi::TextCanvas> ribi::aaf::Molecule::ToTextCanvas() const noexcept {   boost::shared_ptr<TextCanvas> canvas;    const auto l(GetAverageBondLength());   //Map atoms to integer positions    return canvas; }`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafmoleculefactory.h
-----------------------------------

 

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef AAFMOLECULEFACTORY_H #define AAFMOLECULEFACTORY_H  #pragma GCC diagnostic push #pragma GCC diagnostic ignored "-Weffc++" #pragma GCC diagnostic ignored "-Wunused-local-typedefs" #include <boost/graph/adjacency_list.hpp>  #include "aafatom.h" #include "aafbond.h" #include "aafmolecule.h" #include "aafaminoacid.h" #pragma GCC diagnostic pop  namespace ribi { namespace aaf {  struct MoleculeFactory {   MoleculeFactory() {}   boost::shared_ptr<Molecule> Create(const AminoAcid a) const noexcept;    private:   boost::shared_ptr<Molecule> CreateGlycine() const noexcept; };  } //~namespace aaf } //~namespace ribi  #endif // AAFMOLECULEFACTORY_H`
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppAminoAcid/aafmoleculefactory.cpp
-------------------------------------

 

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "aafmoleculefactory.h"  #include <cassert> #include <stdexcept>  #include "aafbond.h"  boost::shared_ptr<ribi::aaf::Molecule> ribi::aaf::MoleculeFactory::Create(   const AminoAcid a ) const noexcept {   switch (a)   {     case AminoAcid::glycine: return CreateGlycine();     default:       assert(!"Should not get here");       throw std::logic_error("ribi::aaf::MoleculeFactory::Create: unknown amino acid");   }   assert(!"Should not get here");   throw std::logic_error("ribi::aaf::MoleculeFactory::Create: unknown amino acid"); }  boost::shared_ptr<ribi::aaf::Molecule> ribi::aaf::MoleculeFactory::CreateGlycine() const noexcept {   typedef Molecule::Graph Graph;   Graph g;    //All vertex names   //Note: cannot use spaces   using namespace boost::units::si;   const auto bond_length(GetAverageBondLength());   typedef PolarCoordinat<Atom::Angle,Atom::Length> Coordinat;    const double pi { boost::math::constants::pi<double>() };   const int n_atoms { 10 };   #ifndef NDEBUG   const int n_bonds {  9 };   #endif   /*    H   H   O    \  |  //     N-C-C    /  |  \   H   H   O-H    8   1   5    \  |  //     4-0-2    /  |  \   7   3   6-9    */   std::vector<Coordinat> coordinats;   coordinats.push_back(Coordinat(0.0 * radian,0.0 * bond_length));   coordinats.push_back(Coordinat(0.0 * pi * radian,1.0 * bond_length));   coordinats.push_back(Coordinat(0.5 * pi * radian,1.0 * bond_length));   coordinats.push_back(Coordinat(1.0 * pi * radian,1.0 * bond_length));   coordinats.push_back(Coordinat(1.5 * pi * radian,1.0 * bond_length));   #ifndef TODO_RJCB   coordinats.push_back(coordinats[2] + Coordinat(( 1.0 / 6.0) * pi * radian,1.0 * bond_length));   coordinats.push_back(coordinats[2] + Coordinat(( 5.0 / 6.0) * pi * radian,1.0 * bond_length));   coordinats.push_back(coordinats[4] + Coordinat(( 7.0 / 6.0) * pi * radian,1.0 * bond_length));   coordinats.push_back(coordinats[4] + Coordinat((11.0 / 6.0) * pi * radian,1.0 * bond_length));   coordinats.push_back(coordinats[6] + Coordinat(0.5 * pi * radian,1.0 * bond_length));   #endif   assert(n_atoms == static_cast<int>(coordinats.size()));    std::vector<Atom> atoms;   atoms.push_back(Atom(AtomType::C,coordinats[0]));   atoms.push_back(Atom(AtomType::H,coordinats[1]));   atoms.push_back(Atom(AtomType::C,coordinats[2]));   atoms.push_back(Atom(AtomType::H,coordinats[3]));   atoms.push_back(Atom(AtomType::N,coordinats[4]));   atoms.push_back(Atom(AtomType::H,coordinats[5]));   atoms.push_back(Atom(AtomType::O,coordinats[6]));   atoms.push_back(Atom(AtomType::H,coordinats[7]));   atoms.push_back(Atom(AtomType::H,coordinats[8]));   atoms.push_back(Atom(AtomType::H,coordinats[9]));   assert(n_atoms == static_cast<int>(atoms.size()));    std::vector<Graph::vertex_descriptor> vertices;   for (int i=0; i!=n_atoms; ++i)   {     vertices.push_back(boost::add_vertex(atoms[i],g));   }    /*    H   H   O    \  |  //     N-C-C    /  |  \   H   H   O-H    8   1   5    \  |  //     4-0-2    /  |  \   7   3   6-9    i     b     f    7    0    4     e-3-a-1-c    6    2    5   h     d     g8j    */    std::vector<Bond> bonds;   bonds.push_back(Bond());   bonds.push_back(Bond());   bonds.push_back(Bond());   bonds.push_back(Bond());   bonds.push_back(Bond(2));   bonds.push_back(Bond());   bonds.push_back(Bond());   bonds.push_back(Bond());   bonds.push_back(Bond());   bonds.push_back(Bond());   assert(n_bonds == static_cast<int>(bonds.size()));    boost::add_edge(vertices[0],vertices[1],bonds[0],g);   boost::add_edge(vertices[0],vertices[2],bonds[0],g);   boost::add_edge(vertices[0],vertices[3],bonds[0],g);   boost::add_edge(vertices[0],vertices[4],bonds[0],g);   boost::add_edge(vertices[2],vertices[5],bonds[0],g);   boost::add_edge(vertices[2],vertices[6],bonds[0],g);   boost::add_edge(vertices[4],vertices[7],bonds[0],g);   boost::add_edge(vertices[4],vertices[8],bonds[0],g);   boost::add_edge(vertices[6],vertices[9],bonds[0],g);   const boost::shared_ptr<Molecule> m {     new Molecule(g)   };   assert(m);   return m; }`
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

 

This page has been created by the [tool](Tools.md)
[CodeToHtml](ToolCodeToHtml.md)
