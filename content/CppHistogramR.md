
 

 

 

 

 

([C++](Cpp.md)) [HistogramR](CppHistogramR.md)
================================================

 

Technical facts
---------------

 

 

 

 

 

 

./CppHistogramR/CppHistogramR.pri
---------------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` INCLUDEPATH += \     ../../Classes/CppHistogramR  SOURCES += \     ../../Classes/CppHistogramR/histogram_r.cpp \     ../../Classes/CppHistogramR/histogram_r_test.cpp  HEADERS  += \     ../../Classes/CppHistogramR/histogram_r.h  OTHER_FILES += \     ../../Classes/CppHistogramR/Licence.txt`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppHistogramR/histogram\_r.h
------------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #ifndef RIBI_HISTOGRAM_R_H #define RIBI_HISTOGRAM_R_H  #include <memory> #include <string> #include <vector>  #include "RInside.h"  struct RInside;  namespace ribi {  struct HistogramR {   enum class GraphicsFormat { png, svg };    HistogramR();    std::string GetVersion() const noexcept;   std::vector<std::string> GetVersionHistory() const noexcept;    ///Plot histogram to file   void ToHistogram(     const std::vector<double>& v,     const std::string& filename,     const GraphicsFormat graphics_format   ) const;    private:    #ifndef NDEBUG   static void Test() noexcept;   #endif };  } //~namespace ribi  #endif // RIBI_HISTOGRAM_R_H`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppHistogramR/histogram\_r.cpp
--------------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "histogram_r.h"  #include <cassert> #include <fstream> #include <sstream> #include <iostream>  #include "ribi_rinside.h" #include "fileio.h"  ribi::HistogramR::HistogramR() {   #ifndef NDEBUG   Test();   #endif }  std::string ribi::HistogramR::GetVersion() const noexcept {   return "1.0"; }  std::vector<std::string> ribi::HistogramR::GetVersionHistory() const noexcept {   return {     "2015-06-20: Version 1.0: initial version"   }; }  void ribi::HistogramR::ToHistogram(   const std::vector<double>& v,   const std::string& filename,   const ribi::HistogramR::GraphicsFormat graphics_format ) const {   assert(!v.empty());   assert(!filename.empty());    //TODO: Test if the user has all required packages   auto& r = ribi::Rinside().Get();    //r.parseEvalQ("library(ape)");   //r.parseEvalQ("library(geiger)");   r["v"] = v;   r["temp_filename"] = filename;    switch (graphics_format)   {     case GraphicsFormat::png:       r.parseEvalQ("png(filename=temp_filename)");     break;     case GraphicsFormat::svg:       r.parseEvalQ("svg(filename=temp_filename)");     break;   }   r.parseEvalQ("hist(v)");   r.parseEvalQ("dev.off()");     if (!ribi::fileio::FileIo().IsRegularFile(filename))   {     std::stringstream s;     s << __FILE__ << "(" << __LINE__ << "): "       << "Could not create image "       << "with filename '" << filename << "'. "       << "Perhaps not all packages (ape, geiger) needed are installed?"     ;     throw std::runtime_error(s.str().c_str());   } }`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppHistogramR/histogram\_r\_test.cpp
--------------------------------------

 

  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` #include "histogram_r.h"  #include <cassert> #include <chrono>  #include "fileio.h" #include "testtimer.h" #include "trace.h" #include "ribi_rinside.h" #include "RInside.h"  #ifndef NDEBUG void ribi::HistogramR::Test() noexcept {   {     static bool is_tested{false};     if (is_tested) return;     is_tested = true;   }   {     ribi::fileio::FileIo();     ribi::Rinside().Get();   }   const ribi::TestTimer test_timer(__func__,__FILE__,1.0);   const bool verbose{false};    ribi::fileio::FileIo f;    HistogramR h;    if (verbose) { TRACE("ToHistogram"); }   {     const std::string filename{f.GetTempFileName(".png")};     const std::vector<double> v = { 1.0,2.0,2.0,3.0,3.0,3.0};     assert(!f.IsRegularFile(filename));     h.ToHistogram(v,filename,HistogramR::GraphicsFormat::png);     assert(f.IsRegularFile(filename));     f.DeleteFile(filename);   } } #endif`
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

 

