
 

 

 

 

 

([C++](Cpp.md)) [Urho3dExample4](CppUrho3dExample4.md)
========================================================

 

Technical facts
---------------

 

[Operating system(s) or programming environment(s)](CppOs.md)

-   ![Lubuntu](PicLubuntu.png) [Lubuntu](CppLubuntu.md) 15.04 (vivid)

[IDE(s)](CppIde.md):

-   ![Qt Creator](PicQtCreator.png) [Qt Creator](CppQtCreator.md) 3.1.1

[Project type](CppQtProjectType.md):

-   ![console](PicConsole.png) [Console
    application](CppConsoleApplication.md)

[C++ standard](CppStandard.md):

-   ![C++98](PicCpp98.png) [C++98](Cpp98.md)

[Compiler(s)](CppCompiler.md):

-   [G++](CppGpp.md) 4.9.2

[Libraries](CppLibrary.md) used:

-   ![STL](PicStl.png) [STL](CppStl.md): GNU ISO C++ Library, version
    4.9.2

 

 

 

 

 

[Qt project file](CppQtProjectFile.md): ./CppUrho3dExample4/CppUrho3dExample4.pro
----------------------------------------------------------------------------------

 

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` include(../../Libraries/Urho3d.pri)  LIBS += \      #/home/frode/Sync/Source/Urho3D/lib/libUrho3D.a \     -lpthread \     -lSDL2 \ #Otherwise use -lSDL     -ldl \     -lGL  DEFINES += URHO3D_COMPILE_QT     #INCLUDEPATH += \ #    /home/frode/Sync/Source/Urho3D/include \ #    /home/frode/Sync/Source/Urho3D/include/Urho3D/ThirdParty \  TEMPLATE = app CONFIG += console CONFIG -= app_bundle CONFIG -= qt  SOURCES += \     mastercontrol.cpp \     oneirocam.cpp \     inputmaster.cpp  HEADERS += \     mastercontrol.h \     oneirocam.h \     inputmaster.h`
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppUrho3dExample4/inputmaster.h
---------------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` //Inspired heavily by work from Frode Lindeijer  #pragma once  #include <Urho3D/Input/Input.h>  #include "mastercontrol.h"  namespace Urho3D { class Drawable; class Node; class Scene; class Sprite; }  using namespace Urho3D;  class InputMaster : public Object {     OBJECT(InputMaster); public:     InputMaster(Context* context, MasterControl* masterControl);     WeakPtr<Node> firstHit_;  private:     MasterControl* masterControl_;      Input* input_;     void HandleMouseDown(StringHash eventType, VariantMap &eventData);     void HandleKeyDown(StringHash eventType, VariantMap &eventData);     void HandleMouseUp(StringHash eventType, VariantMap &eventData);  };`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppUrho3dExample4/inputmaster.cpp
-----------------------------------

 

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` //Inspired heavily by work from Frode Lindeijer  #include <Urho3D/Urho3D.h> #include <Urho3D/Scene/Node.h> #include <Urho3D/Graphics/Graphics.h> #include <Urho3D/Graphics/OctreeQuery.h> #include <Urho3D/IO/FileSystem.h>  #include "inputmaster.h" #include "oneirocam.h"  InputMaster::InputMaster(Context* context, MasterControl* masterControl) : Object(context) {     masterControl_ = masterControl;     input_ = GetSubsystem<Input>();     //Subscribe mouse down event     SubscribeToEvent(E_MOUSEBUTTONDOWN, HANDLER(InputMaster, HandleMouseDown));     //Subscribe key down event.     SubscribeToEvent(E_KEYDOWN, HANDLER(InputMaster, HandleKeyDown)); }  void InputMaster::HandleMouseDown(StringHash eventType, VariantMap &eventData) {     using namespace MouseButtonDown;     int button = eventData[P_BUTTON].GetInt(); }   void InputMaster::HandleMouseUp(StringHash eventType, VariantMap &eventData) {     using namespace MouseButtonUp;     int button = eventData[P_BUTTON].GetInt();     if (button == MOUSEB_LEFT) {}//Deselect when mouse did not move during click on N_VOID }  void InputMaster::HandleKeyDown(StringHash eventType, VariantMap &eventData) {     using namespace KeyDown;     int key = eventData[P_KEY].GetInt();      //Exit when ESC is pressed      //Take screenshot     if (key == KEY_9)     {         Graphics* graphics = GetSubsystem<Graphics>();         Image screenshot(context_);         graphics->TakeScreenShot(screenshot);         //Here we save in the Data folder with date and time appended         String fileName = GetSubsystem<FileSystem>()->GetProgramDir() + "Screenshots/Screenshot_" +                 Time::GetTimeStamp().Replaced(':', '_').Replaced('.', '_').Replaced(' ', '_')+".png";         //Log::Write(1, fileName);         screenshot.SavePNG(fileName);     } }`
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppUrho3dExample4/mastercontrol.h
-----------------------------------

 

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` //Inspired heavily by work from Frode Lindeijer  // // Copyright (c) 2008-2015 the Urho3D project. // // Permission is hereby granted, free of charge, to any person obtaining a copy // of this software and associated documentation files (the "Software"), to deal // in the Software without restriction, including without limitation the rights // to use, copy, modify, merge, publish, distribute, sublicense, and/or sell // copies of the Software, and to permit persons to whom the Software is // furnished to do so, subject to the following conditions: // // The above copyright notice and this permission notice shall be included in // all copies or substantial portions of the Software. // // THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR // IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, // FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE // AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER // LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, // OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN // THE SOFTWARE. //  #pragma once  #include <Urho3D/Urho3D.h> #include <Urho3D/Container/HashMap.h> #include <Urho3D/Engine/Application.h> #include <Urho3D/Graphics/Viewport.h> #include <Urho3D/Graphics/Renderer.h> #include <Urho3D/UI/UI.h> //#include <Urho3D/Physics/RigidBody.h>  namespace Urho3D { class Drawable; class Node; class Scene; class Sprite; }  using namespace Urho3D;  class OneiroCam; class InputMaster;  typedef struct GameWorld {     SharedPtr<OneiroCam> camera;     SharedPtr<Scene> scene;     SharedPtr<Node> backgroundNode;     SharedPtr<Node> voidNode;     struct {         SharedPtr<Node> sceneCursor;         SharedPtr<Cursor> uiCursor;         PODVector<RayQueryResult> hitResults;     } cursor; } GameWorld;  typedef struct HitInfo {     Vector3 position_;     Vector3 hitNormal_;     Node* hitNode_;     Drawable* drawable_; } HitInfo;  namespace { StringHash const N_VOID = StringHash("Void"); StringHash const N_CURSOR = StringHash("Cursor"); StringHash const N_TILEPART = StringHash("TilePart"); StringHash const N_SLOT = StringHash("Slot"); }  class MasterControl : public Application {     /// Enable type information.     OBJECT(MasterControl);     friend class InputMaster; public:     /// Constructor.     MasterControl(Context* context);     GameWorld world;     SharedPtr<ResourceCache> cache_;     SharedPtr<Graphics> graphics_;       /// Setup before engine initialization. Modifies the engine paramaters.     virtual void Setup();     /// Setup after engine initialization.     virtual void Start();     /// Cleanup after the main loop. Called by Application.     virtual void Stop();     void Exit(); private:     SharedPtr<UI> ui_;     SharedPtr<Renderer> renderer_;     SharedPtr<XMLFile> defaultStyle_;      /// Set custom window title and icon     void SetWindowTitleAndIcon();     /// Create console and debug HUD     void CreateConsoleAndDebugHud();      /// Construct the scene content.     void CreateScene();     /// Construct user interface elements.     void CreateUI();     /// Subscribe to application-wide logic update and post-render update events.     void SubscribeToEvents();      /// Handle scene update event to control camera's pitch and yaw.     void HandleSceneUpdate(StringHash eventType, VariantMap& eventData);     /// Handle the logic update event.     void HandleUpdate(StringHash eventType, VariantMap& eventData);     /// Handle the post-render update event.     void HandlePostRenderUpdate(StringHash eventType, VariantMap& eventData);      /// Create a mushroom object at position.     void CreatePlatform(const Vector3 pos);     void UpdateCursor(double timeStep);     /// Utility function to raycast to the cursor position. Return true if hit.     bool CursorRayCast(double maxDistance, PODVector<RayQueryResult> &hitResults);      /// Pause flag     bool paused_; };`
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppUrho3dExample4/mastercontrol.cpp
-------------------------------------

 

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` //Inspired heavily by work from Frode Lindeijer  // // Copyright (c) 2008-2015 the Urho3D project. // // Permission is hereby granted, free of charge, to any person obtaining a copy // of this software and associated documentation files (the "Software"), to deal // in the Software without restriction, including without limitation the rights // to use, copy, modify, merge, publish, distribute, sublicense, and/or sell // copies of the Software, and to permit persons to whom the Software is // furnished to do so, subject to the following conditions: // // The above copyright notice and this permission notice shall be included in // all copies or substantial portions of the Software. // // THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR // IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, // FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE // AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER // LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, // OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN // THE SOFTWARE. //  #include <Urho3D/Urho3D.h> #include <Urho3D/Engine/Engine.h> #include <Urho3D/Engine/Console.h> #include <Urho3D/Graphics/Graphics.h> #include <Urho3D/Graphics/DebugRenderer.h> #include <Urho3D/Engine/DebugHud.h> #include <Urho3D/DebugNew.h> #include <Urho3D/UI/Text.h> #include <Urho3D/UI/Font.h> #include <Urho3D/Scene/Scene.h> #include <Urho3D/Physics/PhysicsWorld.h> #include <Urho3D/Physics/CollisionShape.h> #include <Urho3D/Graphics/Model.h> #include <Urho3D/Graphics/StaticModel.h> #include <Urho3D/Graphics/Light.h> #include <Urho3D/Graphics/Camera.h> #include <Urho3D/Graphics/Material.h> #include <Urho3D/Graphics/RenderPath.h> #include <Urho3D/IO/FileSystem.h> #include <Urho3D/Resource/ResourceCache.h> #include <Urho3D/Resource/XMLFile.h> #include <Urho3D/Resource/Resource.h> #include <Urho3D/Audio/Sound.h> #include <Urho3D/Audio/SoundSource.h>  #include <Urho3D/IO/Log.h> #include <Urho3D/Scene/SceneEvents.h> #include <Urho3D/Core/CoreEvents.h> #include <Urho3D/Graphics/Octree.h> #include <Urho3D/Graphics/OctreeQuery.h>  #include "mastercontrol.h" #include "oneirocam.h" #include "inputmaster.h"  DEFINE_APPLICATION_MAIN(MasterControl);  MasterControl::MasterControl(Context *context):     Application(context),     paused_(false) {   std::system("ln -s ../../Libraries/Urho3D/bin/Data");   std::system("ln -s ../../Libraries/Urho3D/bin/CoreData"); }   void MasterControl::Setup() {     // Modify engine startup parameters.     //Set custom window title and icon.     engineParameters_["WindowTitle"] = "TestVoxelWidget";     engineParameters_["LogName"] = GetSubsystem<FileSystem>()->GetAppPreferencesDir("urho3d", "logs")+"TestVoxelWidget.log";     engineParameters_["FullScreen"] = true;     engineParameters_["Headless"] = false;     engineParameters_["WindowWidth"] = 1980;     engineParameters_["WindowHeight"] = 1080; } void MasterControl::Start() {     new InputMaster(context_, this);     cache_ = GetSubsystem<ResourceCache>();     graphics_ = GetSubsystem<Graphics>();     renderer_ = GetSubsystem<Renderer>();      // Get default style     defaultStyle_ = cache_->GetResource<XMLFile>("UI/DefaultStyle.xml");     SetWindowTitleAndIcon();     //Create console and debug HUD.     CreateConsoleAndDebugHud();     //Create the scene content     CreateScene();     //Create the UI content     CreateUI();     //Hook up to the frame update and render post-update events     SubscribeToEvents();      //Sound* music = cache_->GetResource<Sound>("Resources/Music/Macroform_-_Compassion.ogg"); //Main menu     //Sound* music = cache_->GetResource<Sound>("Resources/Music/Macroform_-_Dreaming.ogg");     /*     Sound* music = cache_->GetResource<Sound>("Resources/Music/Macroform_-_Root.ogg"); //Battle     music->SetLooped(true);     Node* musicNode = world.scene->CreateChild("Music");     SoundSource* musicSource = musicNode->CreateComponent<SoundSource>();     musicSource->SetSoundType(SOUND_MUSIC);     musicSource->Play(music);     */ } void MasterControl::Stop() {     engine_->DumpResources(true); }  void MasterControl::SubscribeToEvents() {     //Subscribe scene update event.     SubscribeToEvent(E_SCENEUPDATE, HANDLER(MasterControl, HandleSceneUpdate));     //Subscribe HandleUpdate() function for processing update events     SubscribeToEvent(E_UPDATE, HANDLER(MasterControl, HandleUpdate));     //Subscribe scene update event.     SubscribeToEvent(E_SCENEUPDATE, HANDLER(MasterControl, HandleSceneUpdate)); }  void MasterControl::SetWindowTitleAndIcon() {     //Create console     Console* console = engine_->CreateConsole();     console->SetDefaultStyle(defaultStyle_);     console->GetBackground()->SetOpacity(0.0f);      //Create debug HUD     DebugHud* debugHud = engine_->CreateDebugHud();     debugHud->SetDefaultStyle(defaultStyle_); }  void MasterControl::CreateConsoleAndDebugHud() {     // Create console     Console* console = engine_->CreateConsole();     console->SetDefaultStyle(defaultStyle_);     console->GetBackground()->SetOpacity(0.8f);      // Create debug HUD.     DebugHud* debugHud = engine_->CreateDebugHud();     debugHud->SetDefaultStyle(defaultStyle_); }  void MasterControl::CreateUI() {     ResourceCache* cache = GetSubsystem<ResourceCache>();     UI* ui = GetSubsystem<UI>();      //Create a Cursor UI element because we want to be able to hide and show it at will. When hidden, the mouse cursor will control the camera     world.cursor.uiCursor = new Cursor(context_);     world.cursor.uiCursor->SetVisible(false);     ui->SetCursor(world.cursor.uiCursor);      //Set starting position of the cursor at the rendering window center     world.cursor.uiCursor->SetPosition(graphics_->GetWidth()/2, graphics_->GetHeight()/2);      //Construct new Text object, set string to display and font to use     Text* instructionText = ui->GetRoot()->CreateChild<Text>();     instructionText->SetText(                 "TestVoxelWidget"                 );     //instructionText->SetFont(cache->GetResource<Font>("Resources/Fonts/Riau.ttf"), 32);     //The text has multiple rows. Center them in relation to each other     instructionText->SetHorizontalAlignment(HA_CENTER);     instructionText->SetVerticalAlignment(VA_CENTER);     instructionText->SetPosition(0, ui->GetRoot()->GetHeight()/2.1); }  void MasterControl::CreateScene() {     world.scene = new Scene(context_);      //Create octree, use default volume (-1000, -1000, -1000) to (1000,1000,1000)     /*Octree* octree = */world.scene->CreateComponent<Octree>();     //octree->SetSize(BoundingBox(Vector3(-10000, -100, -10000), Vector3(10000, 1000, 10000)), 1024);     PhysicsWorld* physicsWorld = world.scene->CreateComponent<PhysicsWorld>();     physicsWorld->SetGravity(Vector3::ZERO);     world.scene->CreateComponent<DebugRenderer>();      //Create cursor     world.cursor.sceneCursor = world.scene->CreateChild("Cursor");     world.cursor.sceneCursor->SetPosition(Vector3(0.0f,0.0f,0.0f));     StaticModel* cursorObject = world.cursor.sceneCursor->CreateComponent<StaticModel>();     //cursorObject->SetModel(cache_->GetResource<Model>("Resources/Models/Cursor.mdl"));     //cursorObject->SetMaterial(cache_->GetResource<Material>("Resources/Materials/glow.xml"));      //Create an invisible plane for mouse raycasting     world.voidNode = world.scene->CreateChild("Void");     //Location is set in update since the plane moves with the camera.     world.voidNode->SetScale(Vector3(1000.0f, 1.0f, 1000.0f));     StaticModel* planeObject = world.voidNode->CreateComponent<StaticModel>();     //planeObject->SetModel(cache_->GetResource<Model>("Models/Plane.mdl"));     //planeObject->SetMaterial(cache_->GetResource<Material>("Resources/Materials/invisible.xml"));      //Create background     for (int i = -2; i <= 2; i++){         for (int j = -2; j <= 2; j++){             world.backgroundNode = world.scene->CreateChild("BackPlane");             world.backgroundNode->SetScale(Vector3(512.0f, 1.0f, 512.0f));             world.backgroundNode->SetPosition(Vector3(512.0f*i, -200.0f, 512.0f*j));             StaticModel* backgroundObject = world.backgroundNode->CreateComponent<StaticModel>();             backgroundObject->SetModel(cache_->GetResource<Model>("Models/Plane.mdl"));             //backgroundObject->SetMaterial(cache_->GetResource<Material>("Resources/Materials/dreamsky.xml"));         }     }     //Create a Zone component for ambient lighting & fog control     /*Node* zoneNode = world.scene_->CreateChild("Zone");     Zone* zone = zoneNode->CreateComponent<Zone>();     zone->SetBoundingBox(BoundingBox(Vector3(-1000.0f, -10.0f, -1000.0f),Vector3(1000.0f, 20.0f, 1000.0f)));     zone->SetAmbientColor(Color(0.15f, 0.15f, 0.15f));     zone->SetFogColor(Color(0.2f, 0.1f, 0.3f));     zone->SetFogStart(100.0f);     zone->SetFogEnd(110.0f);*/      //Create a directional light to the world. Enable cascaded shadows on it     Node* lightNode = world.scene->CreateChild("DirectionalLight");     lightNode->SetDirection(Vector3(0.0f, -1.0f, 0.0f));     Light* light = lightNode->CreateComponent<Light>();     light->SetLightType(LIGHT_DIRECTIONAL);     light->SetBrightness(1.0f);     light->SetColor(Color(1.0f, 0.8f, 0.7f));     light->SetCastShadows(true);     light->SetShadowBias(BiasParameters(0.00025f, 0.5f));      //Create a second directional light without shadows     Node* lightNode2 = world.scene->CreateChild("DirectionalLight");     lightNode2->SetDirection(Vector3(0.0f, 1.0f, 0.0f));     Light* light2 = lightNode2->CreateComponent<Light>();     light2->SetLightType(LIGHT_DIRECTIONAL);     light2->SetBrightness(0.25f);     light2->SetColor(Color(1.0f, 1.0f, 0.9f));     light2->SetCastShadows(true);     light2->SetShadowBias(BiasParameters(0.00025f, 0.5f));      //Set cascade splits at 10, 50, 200 world unitys, fade shadows at 80% of maximum shadow distance     light->SetShadowCascade(CascadeParameters(7.0f, 23.0f, 42.0f, 500.0f, 0.8f));      //Create camera     world.camera = new OneiroCam(context_, this); }  void MasterControl::HandleUpdate(StringHash eventType, VariantMap &eventData) {  }  void MasterControl::HandleSceneUpdate(StringHash eventType, VariantMap &eventData) {     using namespace Update;     double timeStep = eventData[P_TIMESTEP].GetFloat();     world.voidNode->SetPosition((2.0f*Vector3::DOWN) + (world.camera->GetWorldPosition()*Vector3(1.0f,0.0f,1.0f)));     UpdateCursor(timeStep); }  void MasterControl::UpdateCursor(double timeStep) {     world.cursor.sceneCursor->Rotate(Quaternion(0.0f,100.0f*timeStep,0.0f));     world.cursor.sceneCursor->SetScale((world.cursor.sceneCursor->GetWorldPosition() - world.camera->GetWorldPosition()).Length()*0.05f);     if (CursorRayCast(250.0f, world.cursor.hitResults))     {         for (int i = 0; i < world.cursor.hitResults.Size(); i++)         {             if (world.cursor.hitResults[i].node_->GetNameHash() == N_VOID)             {                 Vector3 camHitDifference = world.camera->translationNode_->GetWorldPosition() - world.cursor.hitResults[i].position_;                 camHitDifference /= world.camera->translationNode_->GetWorldPosition().y_ - world.voidNode->GetPosition().y_;                 camHitDifference *= world.camera->translationNode_->GetWorldPosition().y_;                 world.cursor.sceneCursor->SetWorldPosition(world.camera->translationNode_->GetWorldPosition()-camHitDifference);             }         }     } }  bool MasterControl::CursorRayCast(double maxDistance, PODVector<RayQueryResult> &hitResults) {     Ray cameraRay = world.camera->camera_->GetScreenRay(0.5f,0.5f);     RayOctreeQuery query(hitResults, cameraRay, RAY_TRIANGLE, maxDistance, DRAWABLE_GEOMETRY);     world.scene->GetComponent<Octree>()->Raycast(query);     if (hitResults.Size()) return true;     else return false; }  void MasterControl::Exit() {     engine_->Exit(); }  void MasterControl::HandlePostRenderUpdate(StringHash eventType, VariantMap &eventData) {     //world.scene->GetComponent<PhysicsWorld>()->DrawDebugGeometry(true); }`
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppUrho3dExample4/oneirocam.h
-------------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` //Inspired heavily by work from Frode Lindeijer  #pragma once  #include "mastercontrol.h"  namespace Urho3D {   class Drawable;   class Node;   class Scene;   class Sprite;   class Viewport;   class RenderPath;   class RigidBody;   class Camera; }  using namespace Urho3D;  class OneiroCam : public Object {     OBJECT(OneiroCam);     friend class MasterControl;     friend class InputMaster; public:     OneiroCam(Context *context, MasterControl* masterControl);      virtual void Start();     virtual void Stop();      SharedPtr<Camera> camera_;     SharedPtr<Viewport> viewport_;     SharedPtr<RenderPath> effectRenderPath;      Vector3 GetWorldPosition();     Quaternion GetRotation(); private:     MasterControl* masterControl_;     void HandleSceneUpdate(StringHash eventType, VariantMap &eventData);     SharedPtr<Node> translationNode_;     SharedPtr<Node> rotationNode_;      SharedPtr<RigidBody> rigidBody_;     double yaw_ = 0.0;     double pitch_ = 0.0;     //double roll_ = 0.0;     double yawDelta_ = 0.0;     double pitchDelta_ = 0.0;     double forceMultiplier = 1.0;     void SetupViewport(); };`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

./CppUrho3dExample4/oneirocam.cpp
---------------------------------

 

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  ` //Inspired heavily by work from Frode Lindeijer  #include <Urho3D/Urho3D.h> #include <Urho3D/Core/CoreEvents.h> #include <Urho3D/Scene/SceneEvents.h> #include <Urho3D/Graphics/Camera.h> #include <Urho3D/Graphics/Viewport.h> #include <Urho3D/Graphics/RenderPath.h> #include <Urho3D/Graphics/Light.h> #include <Urho3D/Physics/CollisionShape.h> #include <Urho3D/Physics/RigidBody.h> #include <Urho3D/Scene/Scene.h> #include <Urho3D/Resource/ResourceCache.h> #include <Urho3D/Resource/XMLFile.h> #include <Urho3D/Math/MathDefs.h> #include <Urho3D/Input/Input.h>  #include "oneirocam.h"   Vector3 Scale(const Vector3& lhs, const Vector3& rhs) {   return Vector3(     lhs.x_ * rhs.x_,     lhs.y_ * rhs.y_,     lhs.z_ * rhs.z_   ); }   OneiroCam::OneiroCam(Context *context, MasterControl *masterControl):     Object(context) {     masterControl_ = masterControl;     SubscribeToEvent(E_SCENEUPDATE, HANDLER(OneiroCam, HandleSceneUpdate));      //Create the camera. Limit far clip distance to match the fog     translationNode_ = masterControl_->world.scene->CreateChild("CamTrans");     rotationNode_ = translationNode_->CreateChild("CamRot");     camera_ = rotationNode_->CreateComponent<Camera>();     camera_->SetFarClip(1024.0f);     //Set an initial position for the camera scene node above the origin     translationNode_->SetPosition(Vector3(0.0f, 3.0f, 0.0f));     rotationNode_->SetRotation(Quaternion(0.0f, 90.0f, 0.0f));     rigidBody_ = translationNode_->CreateComponent<RigidBody>();     rigidBody_->SetAngularDamping(10.0f);     CollisionShape* collisionShape = translationNode_->CreateComponent<CollisionShape>();     collisionShape->SetSphere(0.1f);     rigidBody_->SetMass(1.0f);      Node* lightNode = translationNode_->CreateChild("DirectionalLight");     lightNode->SetDirection(Vector3(0.0f, -1.0f, 0.0f));     Light* light = lightNode->CreateComponent<Light>();     light->SetLightType(LIGHT_POINT);     light->SetBrightness(0.5f);     light->SetColor(Color(0.7f, 0.9f, 0.6f));     light->SetCastShadows(false);      SetupViewport(); }    void OneiroCam::Start() { }  void OneiroCam::Stop() { }  void OneiroCam::SetupViewport() {     ResourceCache* cache = GetSubsystem<ResourceCache>();     Renderer* renderer = GetSubsystem<Renderer>();      //Set up a viewport to the Renderer subsystem so that the 3D scene can be seen     SharedPtr<Viewport> viewport(new Viewport(context_, masterControl_->world.scene, camera_));     viewport_ = viewport;      //Add anti-asliasing     /*effectRenderPath = viewport_->GetRenderPath()->Clone();     effectRenderPath->Append(cache->GetResource<XMLFile>("PostProcess/FXAA3.xml"));     effectRenderPath->SetEnabled("FXAA3", true);*/      viewport_->SetRenderPath(effectRenderPath);     renderer->SetViewport(0, viewport); }  Vector3 OneiroCam::GetWorldPosition() {     return translationNode_->GetWorldPosition(); }  Quaternion OneiroCam::GetRotation() {     return rotationNode_->GetRotation(); }  void OneiroCam::HandleSceneUpdate(StringHash eventType, VariantMap &eventData) {     using namespace Update;      //Take the frame time step, which is stored as a double     double timeStep = eventData[P_TIMESTEP].GetFloat();     //Movement speed as world units per second     const double MOVE_SPEED = 2000.0;     //Mouse sensitivity as degrees per pixel     const double MOUSE_SENSITIVITY = 0.1;      //Use this frame's mouse motion to adjust camera node yaw and pitch. Clamp the pitch between -90 and 90 degrees. Only move the camera when the cursor is hidden.     Input* input = GetSubsystem<Input>();     IntVector2 mouseMove = input->GetMouseMove();     yawDelta_ = 0.5*(yawDelta_ + MOUSE_SENSITIVITY * mouseMove.x_);     pitchDelta_ = 0.5*(pitchDelta_ + MOUSE_SENSITIVITY * mouseMove.y_);     yaw_ += yawDelta_;     pitch_ += pitchDelta_;     pitch_ = Clamp(pitch_, -89.0, 89.0);     //Construct new orientation for the camera scene node from yaw and pitch. Roll is fixed to zero     translationNode_->SetRotation(Quaternion(0.0f, 0.0f, 0.0f));     rotationNode_->SetRotation(Quaternion(pitch_, yaw_, 0.0f));      //Read WASD keys and move the camera scene node to the corresponding direction if they are pressed     Vector3 camForce = Vector3::ZERO;     if (input->GetKeyDown('W')) camForce += Scale(rotationNode_->GetDirection(), Vector3(1.0f,0.0f,1.0f) ).Normalized();     if (input->GetKeyDown('S')) camForce += Scale(rotationNode_->GetDirection(), Vector3(-1.0f,0.0f,-1.0f) ).Normalized();     if (input->GetKeyDown('D')) camForce += Scale(rotationNode_->GetRight(), Vector3(1.0f,0.0f,1.0f) ).Normalized();     if (input->GetKeyDown('A')) camForce += Scale(rotationNode_->GetRight(), Vector3(-1.0f,0.0f,-1.0f) ).Normalized();     if (input->GetKeyDown('E')) camForce += Vector3::UP;     if (input->GetKeyDown('Q') && translationNode_->GetPosition().y_ > 1.0f) camForce += Vector3::DOWN;     camForce = camForce.Normalized() * MOVE_SPEED * timeStep;      if ( forceMultiplier < 8.0 && (input->GetKeyDown(KEY_LSHIFT)||input->GetKeyDown(KEY_RSHIFT)) ){         forceMultiplier += 0.23;     } else forceMultiplier = pow(forceMultiplier, 0.75);     rigidBody_->ApplyForce( (forceMultiplier * camForce) - (2.3f * rigidBody_->GetLinearVelocity()) );      if (translationNode_->GetPosition().y_ < 1.0f)     {         translationNode_->SetPosition(Vector3(translationNode_->GetPosition().x_, 1.0f, translationNode_->GetPosition().z_));         rigidBody_->SetLinearVelocity(Vector3(rigidBody_->GetLinearVelocity().x_, 0.0f, rigidBody_->GetLinearVelocity().z_));     } }`
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

 

 

 

 

 

 



